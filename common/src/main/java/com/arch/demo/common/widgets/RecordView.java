package com.arch.demo.common.widgets;import android.content.Context;import android.graphics.drawable.AnimationDrawable;import android.util.AttributeSet;import android.view.LayoutInflater;import android.view.View;import android.view.animation.AnimationUtils;import android.view.animation.ScaleAnimation;import android.widget.FrameLayout;import android.widget.ImageView;import com.arch.demo.common.R;public class RecordView extends FrameLayout {    private Context mContext;    private View mProgress;    private ImageView mSpeakAnimation;    public RecordView(Context context) {        this(context, null);    }    public RecordView(Context context, AttributeSet attrs) {        this(context, attrs, 0);    }    public RecordView(Context context, AttributeSet attrs, int defStyleAttr) {        super(context, attrs, defStyleAttr);        init(context);    }    private void init(Context context) {        mContext = context;        View rootView = LayoutInflater.from(mContext).inflate(R.layout.widget_record_view_layout, this, false);        mProgress = rootView.findViewById(R.id.view_progress);        mSpeakAnimation = rootView.findViewById(R.id.iv_speak_record);        addView(rootView);    }    private void startSpeakRecordAnimation() {        AnimationDrawable animPlay = (AnimationDrawable) mSpeakAnimation.getBackground();        animPlay.start();    }    private void stopSpeakRecordAnimation() {        AnimationDrawable animPlay = (AnimationDrawable) mSpeakAnimation.getBackground();        animPlay.stop();    }    private void startProgressAnimation(int duration) {        ScaleAnimation scaleAnimation = (ScaleAnimation) AnimationUtils.loadAnimation(mContext, R.anim.anim_record_progress_scale);        scaleAnimation.setDuration(duration*1000);        mProgress.startAnimation(scaleAnimation);    }    //开始录音    public void start(int duration) {        setVisibility(View.VISIBLE);        startSpeakRecordAnimation();        startProgressAnimation(duration);    }    public void stop() {        stopSpeakRecordAnimation();        setVisibility(View.GONE);    }}